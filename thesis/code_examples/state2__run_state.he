import state1__basics

open state1__basics

let runState init =
  handler
  | return x => fn s => (s, x)
  | get () => fn s => resume  s s
  | put  s => fn _ => resume () s
  | finally f => f init
  end
